# docker box definition
box: maven:3.5.0
# # defining the dev pipeline
dev:
   steps:
     - script:
           name: Exporting_proxy
           code: |
                export http_proxy=http://www-proxy.us.oracle.com:80
                export https_proxy=http://www-proxy.us.oracle.com:80
     - xenoterracide/maven:
        settings: settings.xml
        goals: package

build:
   steps:
      - xenoterracide/maven:
         goals: package

maven-test:
   steps:
    - xenoterracide/maven:
        type: maven test
        goals: test


#push-to-ecr:
#  steps:
#    - internal/docker-push:
#        aws-access-key: $AWS_ACCESS_KEY_ID
#        aws-secret-key: $AWS_SECRET_ACCESS_KEY
#        aws-region: $AWS_REGION
#        aws-registry-id: $AWS_REGISTRY_ID
#        repository: $REPOSITORY_NAME
#
#deploy:
#  steps:
#    - script:
#           name: Exporting_proxy
#           code: |
#                scp -p22 -ihghia_id_rsa -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no target/CounterWebApp.war hghia@10.180.61.180:/var/www
#
push-to-docker:
  steps:
    - internal/docker-push:
        username: $DOCKER_USERNAME
        password: $DOCKER_PASSWORD
        tag: prod-release-1.0.0
        repository: sachinapatil/counterwebapp
        registry: https://registry.hub.docker.com                

